# Module 4 Assignment Lab: REST API with Mongoose

The assignment lab for this module is to build a REST API using Mongoose. 
Unlike the tutorial labs, there will be no step by step instructions but 
all of the information you need to know should be in the modules. Please 
attempt to solve the assignment lab on your own before viewing the solution.

### REST API with Mongoose

In the previous module, you've built a CRUD RESTful with Express and the 
native MongoDB Node.js driver (mongodb on npm). However, as you saw in 
Module 4 Mongoose offers a lot of useful features and benefits compared 
to the native MongoDB driver. Let's use Mongoose as a database library 
and ODM for a server.

In this lab, you'll implement a persistent Express REST API server with
 MongoDB and the Mongoose native driver.

Create a new file server.js which will have the code for the CRUD API 
which will have four endpoints:

	GET /accounts
	POST /accounts
	PUT /accounts/:id
	DELETE /accounts/:id

Use save(), remove(), find() and findById() Mongoose methods to save, 
remove and find documents. Define the account schema as having two fields:

	name: String,
	balance: Number
  
For the Express server, use morgan for request logging, errorhandler for 
error handling and body-parser for parsing of payloads.

When you are done, be sure to test the endpoints!

You can test your endpoints with the following curl requests:

	//posts account data

	curl -H "Content-Type: application/json" -X POST -d '{"balance": "1000", "name": "savings"}' "http://localhost:3000/accounts"

	//gets account data

	curl "http://localhost:3000/accounts"

	//updates account data at specific id, NOTE: replace 'id' in "http://localhost:3000/accounts/id" with the id generated by the previous POST command

	curl -H "Content-Type: application/json" -X POST -d '{"balance": "1500"}' "http://localhost:3000/accounts/id"

	//deletes account data at specific id, NOTE: replace 'id' in "http://localhost:3000/accounts/id" with the id generated by the previous POST command

	curl -X DELETE "http://localhost:3000/posts/id"
	
### Execute mongod
    
    mongod -f /etc/mongodb.conf 

### Execute mongo
    
    mongo

### testing 

First install local dependencies:

    npm install

To run the server:

    node server.js

To test the endpoints:

    # posts account data
    curl -H "Content-Type: application/json" -X POST -d '{"balance": "1000", "name": "savings"}' "http://localhost:8080/accounts"

    # gets account data
    curl "http://localhost:8080/accounts"
    
    # updates account data at specific id
    # NOTE: replace 'id' with the id generated by the previous POST command
    curl -H "Content-Type: application/json" -X PUT -d '{"balance": "1500"}' "http://localhost:8080/accounts/5a66026f8b6e111799c75d87"
    
    # deletes account data at specific id
    # NOTE: replace 'id' with the id generated by the previous POST command
    curl -X DELETE "http://localhost:8080/accounts/5a66026f8b6e111799c75d87"


### MongoDB shell helpful commands

    > show dbs
    > use lab4
    > show tables
    > db.accounts.find({})
    > db.accounts.count()
    > db.accounts.find({_id: ObjectId("5a66795427e3c1296f15c7db")})

### dependencies

* **body-parser**
* **errorhandler**
* **express**
* **mongoose**
* **morgan**

## versions

    $ mongo --version
    MongoDB shell version v3.6.1
    
    $ mongod --version
    db version v3.0.15
    
    $ node --version
    v8.9.1